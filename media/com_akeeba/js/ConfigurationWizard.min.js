if(typeof akeeba=="undefined"){var akeeba={}}if(typeof akeeba.Wizard=="undefined"){akeeba.Wizard={URLs:{},execTimes:[30,25,20,14,7,5,3],blockSizes:[240,200,160,80,40,16,4,2,1],translation:{}}}(function(a){akeeba.Wizard.boot=function(){akeeba.Wizard.execTimes=[30,25,20,14,7,5,3];akeeba.Wizard.blockSizes=[480,400,240,200,160,80,40,16,4,2,1];a("#backup-progress-pane").css("display","block");akeeba.Backup.resetTimeoutBar();akeeba.Wizard.tryAjax()};akeeba.Wizard.tryAjax=function(){akeeba.System.useIFrame=false;akeeba.Backup.resetTimeoutBar();akeeba.Backup.startTimeoutBar(10000,100);a("#step-ajax").addClass("step-active");a("#backup-substep").text(Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_TRYAJAX"));akeeba.System.doAjax({act:"ping"},function(){akeeba.System.useIFrame=false;a("#step-ajax").removeClass("label-info");a("#step-ajax").addClass("label-success");akeeba.Wizard.minExec()},function(){akeeba.System.useIFrame=true;akeeba.Backup.resetTimeoutBar();akeeba.Backup.startTimeoutBar(10000,100);a("#backup-substep").text(Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_TRYIFRAME"));akeeba.System.doAjax({act:"ping"},function(){a("#step-ajax").removeClass("label-info");a("#step-ajax").addClass("label-success");akeeba.Wizard.minExec()},function(){a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_CANTUSEAJAX"))},false,10000)},false,10000)};akeeba.Wizard.minExec=function(c,b){if(c==null){c=0}if(b==null){b=0}akeeba.Backup.resetTimeoutBar();akeeba.Backup.startTimeoutBar((2*c+5)*1000,100);var d=Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_MINEXECTRY").replace("%s",c.toFixed(1));a("#backup-substep").text(d);a("#step-minexec").addClass("label-info");akeeba.System.doAjax({act:"minexec",seconds:c},function(e){b++;if(b<3){akeeba.Wizard.minExec(c,b)}else{akeeba.Wizard.minExecApply(c)}},function(){c+=0.5;if(c>20){a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_CANTDETERMINEMINEXEC"))}else{akeeba.Wizard.minExec(c,0)}},false,(2*c+5)*1000)};akeeba.Wizard.minExecApply=function(c){akeeba.Backup.resetTimeoutBar();akeeba.Backup.startTimeoutBar(25000,100);a("#backup-substep").text(Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_SAVEMINEXEC"));var b=0;if(akeeba.Backup.useIFrame){b=1}akeeba.System.doAjax({act:"applyminexec",iframes:b,minexec:c},function(d){a("#step-minexec").removeClass("label-info");a("#step-minexec").addClass("label-success");akeeba.Wizard.directories()},function(){a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_CANTSAVEMINEXEC"))},false)};akeeba.Wizard.directories=function(){akeeba.Backup.resetTimeoutBar();akeeba.Backup.startTimeoutBar(10000,100);a("#backup-substep").text("");a("#step-directory").addClass("label-info");akeeba.System.doAjax({act:"directories"},function(b){if(b){a("#step-directory").removeClass("label-info");a("#step-directory").addClass("label-success");akeeba.Wizard.database()}else{a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_CANTFIXDIRECTORIES"))}},function(){a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_CANTFIXDIRECTORIES"))},false)};akeeba.Wizard.database=function(){akeeba.Backup.resetTimeoutBar();akeeba.Backup.startTimeoutBar(30000,50);a("#backup-substep").text("");a("#step-dbopt").addClass("label-info");akeeba.System.doAjax({act:"database"},function(b){if(b){a("#step-dbopt").removeClass("label-info");a("#step-dbopt").addClass("label-success");akeeba.Wizard.maxExec()}else{a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_CANTDBOPT"))}},function(){a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_CANTDBOPT"))},false)};akeeba.Wizard.maxExec=function(){var b=array_shift(akeeba.Wizard.execTimes);if(empty(akeeba.Wizard.execTimes)||(b==null)){a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_EXECTOOLOW"));return}akeeba.Backup.resetTimeoutBar();akeeba.Backup.startTimeoutBar((b*1.2)*1000,80);a("#step-maxexec").addClass("label-info");var c=Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_MINEXECTRY").replace("%s",b.toFixed(0));a("#backup-substep").text(c);akeeba.System.doAjax({act:"maxexec",seconds:b},function(d){if(d){akeeba.Wizard.maxExecApply(b)}else{akeeba.Wizard.maxExec()}},function(){akeeba.Wizard.maxExec()},false,38000)};akeeba.Wizard.maxExecApply=function(b){akeeba.Backup.resetTimeoutBar();akeeba.Backup.startTimeoutBar(10000,100);a("#backup-substep").text(Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_SAVINGMAXEXEC"));akeeba.System.doAjax({act:"applymaxexec",seconds:b},function(){a("#step-maxexec").removeClass("label-info");a("#step-maxexec").addClass("label-success");akeeba.Wizard.partSize()},function(){a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_CANTSAVEMAXEXEC"))})};akeeba.Wizard.partSize=function(){akeeba.Backup.resetTimeoutBar();var b=array_shift(akeeba.Wizard.blockSizes);if(empty(akeeba.Wizard.blockSizes)||(b==null)){a("#backup-progress-pane").css("display","none");a("#error-panel").css("display","block");a("#backup-error-message").html(Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_CANTDETERMINEPARTSIZE"));return}var d=b/8;akeeba.Backup.startTimeoutBar(30000,100);var c=Joomla.JText._("COM_AKEEBA_CONFWIZ_UI_PARTSIZE").replace("%s",d.toFixed(3));a("#backup-substep").text(c);a("#step-splitsize").addClass("label-info");akeeba.System.doAjax({act:"partsize",blocks:b},function(e){if(e){a("#step-splitsize").removeClass("label-info");a("#step-splitsize").addClass("label-success");akeeba.Wizard.done()}else{akeeba.Wizard.partSize()}},function(e){akeeba.Wizard.partSize()},false,60000)};akeeba.Wizard.done=function(){a("#backup-progress-pane").hide();a("#backup-complete").show()}}(akeeba.jQuery));