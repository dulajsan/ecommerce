if(typeof(akeeba)=="undefined"){var akeeba={}}if(typeof(akeeba.jQuery)=="undefined"){akeeba.jQuery=jQuery.noConflict()}var AkeebaStepper=function(d){this.options={holder:"#stepper-holder",loading:"#stepper-loading",pane:"#stepper-progress-pane",content:"#stepper-progress-content",steps:"#stepper-steps",status:"#stepper-status",step:"#stepper-step",substep:"#stepper-substep",percentage:"#stepper-percentage",timer:"#response-timer",useIframe:false,domainUrl:"view=Alice&task=domains",pollingUrl:"view=Alice&task=ajax",onBeforeStart:function(h){},onBeforeStep:function(i,h){},onComplete:function(h){}};this.options=akeeba.jQuery.extend(this.options,d||{});var f=this;var b="index.php?option=com_akeeba&tmpl=component&";var e={cache:false,data:{},dataType:"text",success:function(j){var i=new RegExp("###(.*?)###").exec(j);var h=JSON.parse(i[1]);f.renderBars(h.Domain);akeeba.jQuery(f.options.percentage+" div.bar").css({width:h.Progress+"%"});akeeba.jQuery(f.options.step).html(h.Step);akeeba.jQuery(f.options.substep).html(h.Substep);if(h.HasRun==1){f.complete(h)}else{setTimeout(function(){f.step(h)},10)}}};var c=function(){akeeba.jQuery.ajax(b+f.options.domainUrl,{cache:false,dataType:"text",beforeSend:function(){akeeba.jQuery(f.options.loading).show()},success:function(i){var h=new RegExp("###(.*?)###").exec(i);f.domains=JSON.parse(h[1]);akeeba.jQuery(f.options.loading).hide();akeeba.jQuery(f.options.pane).show("fast");f.continueAfterLoad()}})};var g=function(){var h=0;var i=setInterval(function(){h++;var j=Joomla.JText._("COM_AKEEBA_BACKUP_TEXT_LASTRESPONSE").replace("%s",h.toFixed(0));akeeba.jQuery(f.options.timer+" div.text").html(j)},1000);akeeba.jQuery(f.options.timer).data("akeebatimer",i)};var a=function(){var h=akeeba.jQuery(f.options.timer).data("akeebatimer");clearInterval(h);akeeba.jQuery(f.options.timer+" div.text").html(Joomla.JText._("COM_AKEEBA_BACKUP_TEXT_LASTRESPONSE").replace("%s","0"))};this.init=function(){c()};this.continueAfterLoad=function(){this.renderBars();g();this.start()};this.renderBars=function(j){if(j==undefined){j=""}var h="label-success";var i="";akeeba.jQuery(this.options.steps).html("");akeeba.jQuery.each(this.domains,function(k,l){var m=akeeba.jQuery(document.createElement("div")).addClass("label").html(l[1]).data("domain",l[0]).appendTo(f.options.steps);if(l[0]==j){h="";i="label-info"}else{i=h}m.addClass(i)})};this.start=function(){this.options.onBeforeStart(e);e.data.ajax="start";akeeba.jQuery.ajax(b+this.options.pollingUrl,e)};this.step=function(h){this.options.onBeforeStep(e,h);a();g();e.data.ajax="step";akeeba.jQuery.ajax(b+this.options.pollingUrl,e)};this.complete=function(h){a();this.options.onComplete(h)}};