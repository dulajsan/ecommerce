/*! Fabrik */
define(["jquery","fab/tipsBootStrapMock"],function(a,b){var c=new Class({Implements:[Options],options:{selector:"ul.fabrik_action, .btn-group.fabrik_action",method:"floating",floatPos:"bottom"},initialize:function(a,b){this.setOptions(b),this.list=a,this.actions=[],this.setUpSubMenus(),Fabrik.addEvent("fabrik.list.update",function(){this.observe()}.bind(this)),this.observe()},observe:function(){"floating"===this.options.method?this.setUpFloating():this.setUpDefault()},setUpSubMenus:function(){this.list.form&&(this.actions=this.list.form.getElements(this.options.selector),this.actions.each(function(a){if(a.getElement("ul")){var c=a.getElement("ul"),d=new Element("div").adopt(c.clone()),e=c.getPrevious();e.getElement(".fabrikTip")&&(e=e.getElement(".fabrikTip"));{var f=Fabrik.tips?Fabrik.tips.options:{},g=Object.merge(Object.clone(f),{showOn:"click",hideOn:"click",position:"bottom",content:d});new b(e,g)}c.dispose()}}))},setUpDefault:function(){this.actions=this.list.form.getElements(this.options.selector),this.actions.each(function(a){if(!a.getParent().hasClass("fabrik_buttons")){a.fade(.6);var b=a.getParent(a.getParent(".fabrik_row")?".fabrik_row":".fabrik___heading");b&&b.addEvents({mouseenter:function(){a.fade(.99)},mouseleave:function(){a.fade(.6)}})}})},setUpFloating:function(){var a,c=!1;this.list.form.getElements(this.options.selector).each(function(d){if(d.getParent(".fabrik_row")&&(a=d.getParent(".fabrik_row").getElement("input[type=checkbox]"))){c=!0;{var e=function(){var a=d.getParent();return a.store("activeRow",d.getParent(".fabrik_row")),a}.bind(this.list),f={position:this.options.floatPos,showOn:"change",hideOn:"click",content:e,heading:"Edit: ",hideFn:function(a){return!a.target.checked},showFn:function(a,b){return Fabrik.activeRow=d.getParent().retrieve("activeRow"),b.store("list",this.list),a.target.checked}.bind(this.list)},g=Fabrik.tips?Object.merge(Object.clone(Fabrik.tips.options),f):f;new b(a,g)}}}.bind(this)),this.list.form.getElements(".fabrik_select input[type=checkbox]").addEvent("click",function(a){Fabrik.activeRow=a.target.getParent(".fabrik_row")});var d=this.list.form.getElement("input[name=checkAll]");"null"!==typeOf(d)&&d.store("listid",this.list.id);{var e=function(a){var b=a.getParent(".fabrik___heading");return"null"!==typeOf(b)?b.getElement(this.options.selector):""}.bind(this),f=Fabrik.tips?Object.clone(Fabrik.tips.options):{},g=Object.merge(f,{position:this.options.floatPos,html:!0,showOn:"click",hideOn:"click",content:e,heading:"Edit all: ",hideFn:function(a){return!a.target.checked},showFn:function(a,b){return b.retrieve("tip").click.store("list",this.list),a.target.checked}.bind(this.list)});new b(d,g)}if(this.list.form.getElements(".fabrik_actions")&&c&&this.list.form.getElements(".fabrik_actions").hide(),this.list.form.getElements(".fabrik_calculation")){var h=this.list.form.getElements(".fabrik_calculation").getLast();"null"!==typeOf(h)&&h.hide()}}});return c});